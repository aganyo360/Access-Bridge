{% extends "base.html" %}
{% block title %}Organizations{% endblock %}

{% block content %}

<style>
    .container {
        width: 90%;
        margin: 30px auto;
    }

    .filters {
        display: flex;
        gap: 15px;
        margin-bottom: 20px;
    }

    .filters input, .filters button {
        padding: 10px;
        font-size: 15px;
        border-radius: 6px;
        border: 1px solid #ccc;
    }

    .org-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
    }

    .org-card {
        background: white;
        flex: 1 1 300px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        padding: 20px;
        transition: transform 0.2s;
        text-align: center;
    }

    .org-card:hover {
        transform: translateY(-5px);
    }

    .org-card h3 {
        color: #2c7be5;
    }

    .org-card p {
        margin: 5px 0;
        opacity: 0.8;
    }

    .org-card a {
        text-decoration: none;
        color: #fff;
        background: #2c7be5;
        padding: 8px 12px;
        border-radius: 6px;
        display: inline-block;
        margin-top: 10px;
    }
</style>

<div class="container">

    <h2>All Organizations</h2>

    <div class="filters">
        <input type="text" id="orgNameInput" placeholder="Search by organization name">
        <button onclick="loadOrganizations()">Search</button>
    </div>

    <div class="org-grid" id="orgGrid"></div>

</div>

<script>
    function loadOrganizations() {
        const nameQuery = document.getElementById("orgNameInput").value;
        let url = "/api/organizations/?";
        if(nameQuery) url += `name=${nameQuery}&`;

        fetch(url)
            .then(res => res.json())
            .then(data => {
                const grid = document.getElementById("orgGrid");
                grid.innerHTML = "";
                data.forEach(org => {
                    const card = document.createElement("div");
                    card.className = "org-card";
                    card.innerHTML = `
                        <h3>${org.name}</h3>
                        <p><b>City:</b> ${org.city || "N/A"}</p>
                        <p>${org.description || "No description provided."}</p>
                        <a href="/organization/${org.id}/">View Services</a>
                    `;
                    grid.appendChild(card);
                });
            })
            .catch(err => console.error(err));
    }

    loadOrganizations(); // initial load
</script>

{% endblock %}
