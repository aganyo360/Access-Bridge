{% extends 'base.html' %}
{% block title %}Home{% endblock %}

{% block content %}

<style>
/* All original CSS except header */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: "Segoe UI", sans-serif;
}

body {
    background: #f5f7fa;
    color: #333;
}

/* HERO SECTION */
.hero {
    height: 70vh;
    background: url('../static/hero.jpg') no-repeat center center/cover;
    color: white;
    display: flex;
    align-items: center;
    padding-left: 60px;
    position: relative;
    margin-top: 80px; /* Space for sticky header */
}

.hero::after {
    content: "";
    position: absolute;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.45);
}

.hero-text {
    position: relative;
    z-index: 5;
    max-width: 500px;
}

.hero-text h1 {
    font-size: 50px;
    font-weight: 800;
    line-height: 1.2;
}

.hero-text p {
    margin-top: 15px;
    font-size: 20px;
    opacity: 0.9;
}

.hero-buttons {
    margin-top: 25px;
}

.btn {
    display: inline-block;
    padding: 12px 22px;
    margin-right: 10px;
    border-radius: 6px;
    text-decoration: none;
    font-size: 17px;
    font-weight: 600;
    color: white;
    transition: 0.3s;
}

.btn-blue {
    background: #2c7be5;
}

.btn-blue:hover {
    background: #165fc0;
}

.btn-outline {
    border: 2px solid white;
}

.btn-outline:hover {
    background: white;
    color: #333;
}

/* FEATURES SECTION */
.features {
    padding: 70px 50px;
    text-align: center;
}

.features h2 {
    font-size: 32px;
    font-weight: 700;
    margin-bottom: 40px;
}

.feature-grid {
    display: flex;
    justify-content: center;
    gap: 25px;
    flex-wrap: wrap;
}

.feature-card {
    background: white;
    width: 280px;
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    text-align: center;
}

.feature-card img {
    width: 60px;
    opacity: 0.8;
}

.feature-card h3 {
    margin-top: 15px;
    font-size: 22px;
}

.feature-card p {
    margin-top: 10px;
    opacity: 0.7;
}

/* MAP PREVIEW */
.map-section {
    padding: 50px 20px;
    display: flex;
    justify-content: center; /* center the map */
}

.map-container {
    width: 100%;
    max-width: 1200px; /* container width */
    height: 380px; /* fixed height */
    border-radius: 14px;
    overflow: hidden; /* contain map inside */
    box-shadow: 0 4px 10px rgba(0,0,0,0.15);
}

#mapPreview {
    width: 100%;
    height: 100%; /* fill the container */
}


</style>

<section class="hero">
    <div class="hero-text">
        <h1>Find Accessible Services Across Kenya</h1>
        <p>Discover disability-friendly clinics, centers, and support services near you.</p>

        <div class="hero-buttons">
            <a href="#mapPreview" class="btn btn-blue">Explore Map</a>
            <a href="/services/" class="btn btn-outline">Browse Services</a>
        </div>
    </div>
</section>

<section class="features">
    <h2>Why Accessible Kenya?</h2>

    <div class="feature-grid">
        <div class="feature-card">
            <img src="https://cdn-icons-png.flaticon.com/128/535/535239.png">
            <h3>Verified Services</h3>
            <p>All listed organizations are verified for accuracy and reliability.</p>
        </div>

        <div class="feature-card">
            <img src="https://cdn-icons-png.flaticon.com/128/1008/1008927.png">
            <h3>Accessibility First</h3>
            <p>Find exactly what you need — wheelchair access, sign language, visual guidance, and more.</p>
        </div>

        <div class="feature-card">
            <img src="https://cdn-icons-png.flaticon.com/128/854/854878.png">
            <h3>Nationwide Coverage</h3>
            <p>Discover centers from Nairobi to Kisumu, Mombasa, Eldoret, and beyond.</p>
        </div>
    </div>
</section>

<section class="map-section">
    <div class="map-container">
        <div id="mapPreview"></div>
    </div>
</section>


<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    const map = L.map('mapPreview').setView([-1.286389, 36.817223], 11);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap contributors'
}).addTo(map);

let markers = [];

fetch("/api/services/")
    .then(res => res.json())
    .then(data => {
        data.forEach(service => {
            const marker = L.marker([service.latitude, service.longitude]).addTo(map);
            marker.bindPopup(`<b>${service.name}</b><br>${service.city}`);
            markers.push(marker);
        });

        // FIX: force Leaflet to recalc map size
        setTimeout(() => {
            map.invalidateSize();
        }, 100);
    });

</script>

{% endblock %}
